%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#3b82f6', 'primaryTextColor': '#ffffff', 'lineColor': '#475569', 'fontSize': '18px'}, 'flowchart': {'nodeSpacing': 30, 'rankSpacing': 50}}}%%

flowchart LR
    subgraph DEL["DELIVERY"]
        PDF["PDF Phishing"] --> DBD["DbD Server"]
        DBD --> PAY["Payloads"]
    end

    subgraph VIC["VICTIM"]
        AGENT["Rust Agent"]
    end

    subgraph ATK["ATTACKER"]
        C2["C2 Server"]
        LOOT["Loot"]
    end

    PAY -->|"Download"| AGENT
    AGENT <-->|"Pinggy Tunnel"| C2
    AGENT -.->|"Exfil"| LOOT

    classDef del fill:#f97316,stroke:#c2410c,color:#fff,stroke-width:3px
    classDef vic fill:#ef4444,stroke:#b91c1c,color:#fff,stroke-width:3px
    classDef atk fill:#22c55e,stroke:#15803d,color:#fff,stroke-width:3px

    class PDF,DBD,PAY del
    class AGENT vic
    class C2,LOOT atk
