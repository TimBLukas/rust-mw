use sysinfo::System;

pub fn is_safe_environment() -> bool {
    let mut sys = System::new_all();

    sys.refresh_memory();

    // RAM prüfen
    let total_memory_mb = sys.total_memory() / 1024;

    // Für Beispiel: test ob mehr als 3 GB
    if total_memory_mb < 3072 {
        println!(
            "[EVASION] Zu wenig RAM ({} MB). Sandbox Verdacht!",
            total_memory_mb
        );
        return false;
    }

    // CPU Cores prüfen
    if sys.cpus().len() < 3 {
        println!(
            "[EVASION] Zu wenig CPU Cores ({}). VM Verdacht!",
            sys.cpus().len()
        );
        return false;
    }

    true
}
